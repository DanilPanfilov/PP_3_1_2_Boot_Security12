<!DOCTYPE html>
<html lang="en" class="h-100"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <title>Admin Page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body>

<script
        src="https://code.jquery.com/jquery-3.6.3.min.js"
        integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU="
        crossorigin="anonymous"></script>
<!--<script type="text/javascript" src="@{/js/user_loader.js}"></script>-->
<script>document.addEventListener('DOMContentLoaded', tableBuilder);

async function tableBuilder() {

  const table = document.getElementById('users');
  let users = await getData();

  let userData = '';
  for (let user of users) {

    // let roles = [];
    // for (let role of user.roles) {
    //     roles.push(' ' + role.name.toString().replaceAll('ROLE_', ''));
    // }
    userData += '<tr>';
    userData += '<td>' + user.id + '</td>';
    userData += '<td>' + user.username + '</td>';
    userData += '<td>' + user.name + '</td>';
    userData += '<td>' + user.lastName+ '</td>';
    // userData += '<td>' + roles + '</td>';
    // userData += '<td>' + '<a type="button" class="btn btn-primary" data-bs-toggle="modal" ' +
    //     'data-bs-target="#modalFrame" onclick="editUser(' + user.id + ')">Edit</a>' + '</td>';
    // userData += '<td>' + '<a type="button" class="btn btn-danger" data-bs-toggle="modal" ' +
    //     'data-bs-target="#modalFrame" onclick="deleteUser(' + user.id + ')">Delete</a>' + '</td>';
    userData += '</tr>';
  }
  table.innerHTML = userData;
}
async function getData() {
  const url = '/api/getAllUsers';
  let response = await fetch(url);
  console.log(response.json());
  return response.json();
}
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
</body>
</html>